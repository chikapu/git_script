
Private Sub CommandButton1_Click()

Dim myFile As String
Dim rng As Range
Dim cellValue As Variant
Dim col, row As Integer

Dim rgStart, rgEnd As Range
Set rgStart = Range("D24:W40").Find("###start")
Set rgEnd = Range("D24:W40").Find("###end")

Set rng = Range(rgStart, rgEnd)
For col = 2 To (rng.Columns.Count - 1)
    myFile = "C:\Users\kimik\Desktop\workspace\excel\new_" & rng.Cells(1, col) & ".txt"
    Open myFile For Output As #1
    For row = 2 To rng.Rows.Count
        cellValue = rng.Cells(row, col).Value
        If cellValue = "" Then
        Else
            Print #1, cellValue
        End If
    Next row
    Close #1
Next col

End Sub
